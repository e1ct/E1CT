<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/default">

	<!-- index.html 고유 CSS 추가 -->
	<th:block layout:fragment="css">
	</th:block>

	<!-- index.html 고유 스크립트 추가 -->
	<th:block layout:fragment="script">
	</th:block>

	<div layout:fragment="content">
		<div class="sub-visual sub-vs-3">
			<h1>정보조회서비스</h1>
			<p>E1컨테이너터미널은 세계를 목표로 나아갑니다.</p>
		</div><!--sub-visual-->
		<div class="sub-nav">
			<div class="wr"> 
				<a href="/" class="sub-home"></a>
				<div class="sub-depth">
					<h3>정보조회서비스</h3>
					<ul>
						<li><a href="/company/greeting">회사소개</a></li>
						<li><a href="/terminal/facilities">터미널소개</a></li>
						<li><a href="/info/terminal/berthText">정보조회서비스</a></li>
						<li><a href="/community/news">커뮤니티</a></li>
					</ul>
				</div>
				<div class="sub-depth">
					<h3>EDI전송</h3>
					<ul>
						<li th:each="submenu, i:${subMenuList}">
							<a th:href="${submenu.url}" th:text="${i18n} == 'en' ? ${submenu.menuNameEn} : ${submenu.menuNameKo}"></a>
						</li>
					</ul>
				</div>
				<div class="sub-depth">
					<h3>반입 사전정보 입력</h3>
					<ul>
						<li><a href="/info/edi/copinoList">반출입 사전정보 조회</a></li>
						<li><a href="/info/edi/copinoGateInIns">반입 사전정보 입력</a></li>
						<li><a href="/info/edi/copinoGateOutIns">반출 사전정보 입력</a></li>
						<li><a href="/info/edi/byVslCll">모선별 CLL접수 목록</a></li>
						<li><a href="/info/edi/copinoGateInRsrv">반출/입 사전예약</a></li>
						<li><a href="/info/edi/copinoGateInRsrvList">반출/입 사전예약 조회</a></li>
					</ul>
				</div>
			</div>
		</div>
		<section id="info_section">
			<h1 class="title">반입 사전정보 입력</h1>
			<h3 class="subtitle">반출입 예정정보(COPINO)전송현황<small style='float:right'>* 오류전송제외 (단위:VAN)</small></h3>
			
			<div class="date_sch">
				<p>※ 반출입예정시간대를 참조한 COPINO전송 시간대별 현황입니다.</p>
				<p>※ 운송사에서는 <strong>정확한 반출입예정시간</strong>을 입력하여 전송해 주시기 바랍니다.</p>
				<p>※ 상기 자료를 참조하시어 입력시 반출입이 적은 시간대를 선택하여 입력하시오 시간을 엄수해 주시기 바랍니다.</p>
			</div>
			
			<div class="tb_tmnl">
				<table>
					<thead>
						<tr>
							<th>구분</th>
							<th>06시</th>
							<th>07시</th>
							<th>08시</th>
							<th>09시</th>
							<th>10시</th>
							<th>11시</th>
							<th>12시</th>
							<th>13시</th>
							<th>14시</th>
							<th>15시</th>
							<th>16시</th>
							<th>17시</th>
							<th>18시</th>
							<th>19시</th>
							<th>20시</th>
							<th>21시</th>
							<th>22시</th>
							<th>23시</th>
							<th>24시</th>
							<th>01시</th>
							<th>02시</th>
							<th>03시</th>
							<th>04시</th>
							<th>05시</th>
							<th>TTL</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="copino, c:${copinoTimes}">
							<div th:if="${copino.gbn} == 'I'" th:remove="tag">
								<td th:text="'반입'" style='color: blue;'></td>
								<td th:text="( ${copino.time6} == '0' ) ? '-' : ${copino.time6}"></td>
								<td th:text="( ${copino.time7} == '0' ) ? '-' : ${copino.time7}"></td>
								<td th:text="( ${copino.time8} == '0' ) ? '-' : ${copino.time8}"></td>
								<td th:text="( ${copino.time9} == '0' ) ? '-' : ${copino.time9}"></td>
								<td th:text="( ${copino.time10} == '0' ) ? '-' : ${copino.time10}"></td>
								<td th:text="( ${copino.time11} == '0' ) ? '-' : ${copino.time11}"></td>
								<td th:text="( ${copino.time12} == '0' ) ? '-' : ${copino.time12}"></td>
								<td th:text="( ${copino.time13} == '0' ) ? '-' : ${copino.time13}"></td>
								<td th:text="( ${copino.time14} == '0' ) ? '-' : ${copino.time14}"></td>
								<td th:text="( ${copino.time15} == '0' ) ? '-' : ${copino.time15}"></td>
								<td th:text="( ${copino.time16} == '0' ) ? '-' : ${copino.time16}"></td>
								<td th:text="( ${copino.time17} == '0' ) ? '-' : ${copino.time17}"></td>
								<td th:text="( ${copino.time18} == '0' ) ? '-' : ${copino.time18}"></td>
								<td th:text="( ${copino.time19} == '0' ) ? '-' : ${copino.time19}"></td>
								<td th:text="( ${copino.time20} == '0' ) ? '-' : ${copino.time20}"></td>
								<td th:text="( ${copino.time21} == '0' ) ? '-' : ${copino.time21}"></td>
								<td th:text="( ${copino.time22} == '0' ) ? '-' : ${copino.time22}"></td>
								<td th:text="( ${copino.time23} == '0' ) ? '-' : ${copino.time23}"></td>
								<td th:text="( ${copino.time24} == '0' ) ? '-' : ${copino.time24}"></td>
								<td th:text="( ${copino.time1} == '0' ) ? '-' : ${copino.time1}"></td>
								<td th:text="( ${copino.time2} == '0' ) ? '-' : ${copino.time2}"></td>
								<td th:text="( ${copino.time3} == '0' ) ? '-' : ${copino.time3}"></td>
								<td th:text="( ${copino.time4} == '0' ) ? '-' : ${copino.time4}"></td>
								<td th:text="( ${copino.time5} == '0' ) ? '-' : ${copino.time5}"></td>
								<td th:text="( ${copino.tot} == '0' ) ? '-' : ${copino.tot}"></td>
							</div>
							<div th:unless="${copino.gbn} == 'I'" th:remove="tag">
								<td th:text="'반출'" style='color: red;'></td>
								<td th:text="( ${copino.time6} == '0' ) ? '-' : ${copino.time6}"></td>
								<td th:text="( ${copino.time7} == '0' ) ? '-' : ${copino.time7}"></td>
								<td th:text="( ${copino.time8} == '0' ) ? '-' : ${copino.time8}"></td>
								<td th:text="( ${copino.time9} == '0' ) ? '-' : ${copino.time9}"></td>
								<td th:text="( ${copino.time10} == '0' ) ? '-' : ${copino.time10}"></td>
								<td th:text="( ${copino.time11} == '0' ) ? '-' : ${copino.time11}"></td>
								<td th:text="( ${copino.time12} == '0' ) ? '-' : ${copino.time12}"></td>
								<td th:text="( ${copino.time13} == '0' ) ? '-' : ${copino.time13}"></td>
								<td th:text="( ${copino.time14} == '0' ) ? '-' : ${copino.time14}"></td>
								<td th:text="( ${copino.time15} == '0' ) ? '-' : ${copino.time15}"></td>
								<td th:text="( ${copino.time16} == '0' ) ? '-' : ${copino.time16}"></td>
								<td th:text="( ${copino.time17} == '0' ) ? '-' : ${copino.time17}"></td>
								<td th:text="( ${copino.time18} == '0' ) ? '-' : ${copino.time18}"></td>
								<td th:text="( ${copino.time19} == '0' ) ? '-' : ${copino.time19}"></td>
								<td th:text="( ${copino.time20} == '0' ) ? '-' : ${copino.time20}"></td>
								<td th:text="( ${copino.time21} == '0' ) ? '-' : ${copino.time21}"></td>
								<td th:text="( ${copino.time22} == '0' ) ? '-' : ${copino.time22}"></td>
								<td th:text="( ${copino.time23} == '0' ) ? '-' : ${copino.time23}"></td>
								<td th:text="( ${copino.time24} == '0' ) ? '-' : ${copino.time24}"></td>
								<td th:text="( ${copino.time1} == '0' ) ? '-' : ${copino.time1}"></td>
								<td th:text="( ${copino.time2} == '0' ) ? '-' : ${copino.time2}"></td>
								<td th:text="( ${copino.time3} == '0' ) ? '-' : ${copino.time3}"></td>
								<td th:text="( ${copino.time4} == '0' ) ? '-' : ${copino.time4}"></td>
								<td th:text="( ${copino.time5} == '0' ) ? '-' : ${copino.time5}"></td>
								<td th:text="( ${copino.tot} == '' ) ? '-' : ${copino.tot}"></td>
							</div>
						</tr>
					</tbody>
				</table>
			</div>
			
			<form name="saveForm" action="/info/edi/copinoGateInRsrvSave" method="POST">
				<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
				<input type="hidden" name="ioCd" value="IN">
				<input type="hidden" name="copinoYn" value="IS">
				<input type="hidden" name="truckerId" th:value="${#authentication.name}">
				
								
				<div class="tb_tmnl">
					<table>
						<thead>
							
						</thead>
						<tbody>
							<tr>
								<th th:text="'수출입구분'"></th>
								<td class="form-group">
									<input type="radio" name="ixCd" value="I" id="ixCd_i">
									<label for="ixCd_i" th:text="'수입'"></label>
									<input type="radio" name="ixCd" value="O" id="ixCd_o" checked>
									<label for="ixCd_o" th:text="'수출'"></label>
								</td>
								<th th:text="'운송사 ID'"></th>
								<td sec:authorize="hasRole('T')">
									<input type="text" name="transId" th:value="${#authentication.name}" readonly>
								</td>
								<td>
								<!--  sec:authorize="hasRole('S')" -->
									<select name="transId">
										<option value="" th:text="':::::: 선택 ::::::'"></option>
										<div th:each="emp, i:${empList}" th:remove="tag">
											<option th:value="${emp.empNo}" th:text="${emp.empNo}"></option>
										</div>
									</select>
								</td>
							</tr>
							<tr>
								<th th:text="'모선정보'"></th>
								<td th:colspan="3">
									<input type="text" class="sm" name="shipCd">
									<input type="text" class="sm" name="callNo">
									<input type="text" class="sm" name="callYy">
									<a href="#" class="btn-logis" alt="'모선정보'"></a>
									<input type="text" name="shipNm">
								</td>
							</tr>
							<tr>
								<th th:text="'선사'"></th>
								<td th:colspan="3">
									<select name="operCd">
										<div th:each="oper, i:${operList}" th:remove="tag">
											<option th:if="${oper.webCd} == 'N'" th:value="${oper.operCd} + ' - KL-NET(e-Trans)를 이용하여 전송하세요!'"></option>
											<option th:unless="${oper.webCd} == 'N'" th:value="${oper.operCd}" th:text="${oper.operCd} + '-' + ${oper.operKnm}"></option>
										</div>
									</select>
								</td>
							</tr>
							<tr>
								<th th:text="'반입예정일시'"></th>
								<td th:colspan="3">
									<input type="text" name="estDay" id="estDay" class="datepicker-here" data-language="en" autocomplete="off">
									<select name="estTime">
										<div th:each="est:${#numbers.sequence(1, 24)}" th:remove="tag">
											<option th:value="${#numbers.formatInteger(est, 2)}" th:text="${#numbers.formatInteger(est, 2)} + '시'"></option>
										</div>
									</select>
									<select name="estMin">
										<option value="00">00분경</option>
										<option value="10">10분경</option>
										<option value="20">20분경</option>
										<option value="30">30분경</option>
										<option value="40">40분경</option>
										<option value="50">50분경</option>
									</select>
								</td>
							</tr>
							<tr>
								<th th:text="'컨테이너번호'"></th>
								<td>
									<input type="text" name="cntrNo">
								</td>
								<th th:text="'적공구분'"></th>
								<td>
									<select name="fmCd">
										<option value="F" th:text="Full"></option>
										<option value="E" th:text="Empty"></option>
									</select>
								</td>
							</tr>
							<tr>
								<th th:text="'컨테이너 규격'"></th>
								<td th:colspan="3">
									<select id="cntrSzCdSelect">
										<option value="20">20'</option>
										<option value="40">40'</option>
										<option value="45">45'</option>
									</select>
									<select id="cntrSzSelect">
										<option data-szcd="20" value="2210">[2210] 20' Closed Cntr</option>
										<option data-szcd="20" value="2030">[2030] 20' Refrigerated Cntr</option>
										<option data-szcd="20" value="2050">[2050] 20' Open Top Cntr</option>
										<option data-szcd="20" value="2060">[2060] 20' Flat Rack</option>
										<option data-szcd="20" value="2070">[2070] 20' Tank Cntr</option>
										<option data-szcd="20" value="2080">[2080] 20' Special Cntr</option>
										<option data-szcd="20" value="2090">[2090] 20' Air Cntr</option>
										<option data-szcd="40" value="4310">[4310] 40' Closed Cntr</option>
										<option data-szcd="40" value="4330">[4330] 40' Refrigerated Cntr</option>
										<option data-szcd="40" value="4350">[4350] 40' Open Top Cntr</option>
										<option data-szcd="40" value="4360">[4360] 40' Flat Rack</option>
										<option data-szcd="40" value="4370">[4370] 40' Tank Cntr</option>
										<option data-szcd="40" value="4380">[4380] 40' Special Cntr</option>
										<option data-szcd="40" value="4390">[4390] 40' Air Cntr</option>
										<option data-szcd="40" value="4510">[4510] 40' HC Closed Cntr</option>
										<option data-szcd="40" value="4530">[4530] 40' HC Refrigerated Cntr</option>
										<option data-szcd="40" value="4550">[4550] 40' HC Open Top Cntr</option>
										<option data-szcd="40" value="4560">[4560] 40' HC Flat Rack</option>
										<option data-szcd="40" value="4570">[4570] 40' HC Tank Cntr</option>
										<option data-szcd="40" value="4580">[4580] 40' HC Special Cntr</option>
										<option data-szcd="40" value="4590">[4590] 40' HC Air Cntr</option>
										<option data-szcd="45" value="9510">[9510] 45' JUMBO Closed Cntr</option>
										<option data-szcd="45" value="9530">[9530] 45' JUMBO Refrigerated Cntr</option>
										<option data-szcd="45" value="9550">[9550] 45' JUMBO Open Top Cntr</option>
										<option data-szcd="45" value="9560">[9560] 45' JUMBO Flat Rack</option>
										<option data-szcd="45" value="9570">[9570] 45' JUMBO Tank Cntr</option>
										<option data-szcd="45" value="9580">[9580] 45' JUMBO Special Cntr</option>
										<option data-szcd="45" value="9590">[9590] 45' JUMBO Air Cntr</option>
									</select>
									<input type="text" id="sztpCd" class="sm" name="sztpCd" readonly>
								</td>
							</tr>
							<tr>
								<th th:text="'봉인번호'"></th>
								<td>
									<input type="text" name="sealNo">
								</td>
								<th th:text="'차량번호'"></th>
								<td>
									<input type="text" name="carNo">
									<a class="car_btn" th:text="'차량등록확인'" href="#" th:onclick="javascript:carFind()"></a>
								</td>
							</tr>
							<tr>
								<th th:text="'중량'"></th>
								<td>
									<input type="text" name="weight"> Ton (TARE WT 포함)
								</td>
								<th th:text="'냉동온도'"></th>
								<td class="form-group">
									<input type="text" class="sm" name="tempCd">
									<input id="tempId_d" type="radio" name="tempId" value="D" checked>
									<label for="tempId_d" th:text="'DRY'"></label>
									<input id="tempId_c" type="radio" name="tempId" value="C">
									<label for="tempId_c" th:text="'℃'"></label>
									<input id="tempId_f" type="radio" name="tempId" value="F">
									<label for="tempId_f" th:text="'℉'"></label>
								</td>
							</tr>
							<tr>
								<th th:text="'초과규격(H/W/L)'"></th>
								<td>
									<input type="text" class="sm" name="overH">
									<input type="text" class="sm" name="overW">
									<input type="text" class="sm" name="overL">
								</td>
								<th th:text="'위험물코드'"></th>
								<td>
									<input type="text" name="dgCode">
									<input type="radio" name="dgType" value="IMDG" checked> IMDG
								</td>
							</tr>
							<tr>
								<th th:text="'출발지'"></th>
								<td th:colspan="3">
									<input type="text" class="sm" name="posCd">
									<a href="#" class="btn-anchor" th:alt="'검색'" onclick="javascript:window.open('/info/edi/copinoPortList?code=pos', 400, 400);"></a>
									<input type="text" name="posNm">
								</td>
							</tr>
							<tr>
								<th th:text="'적하항'"></th>
								<td th:colspan="3">
									<input type="text" class="sm" name="polCd">
									<a href="#" class="btn-anchor" th:alt="'검색'" onclick="javascript:window.open('/info/edi/copinoPortList?code=pol', 400, 400);"></a>
									<input type="text" name="polNm">
								</td>
							</tr>
							<tr>
								<th th:text="'양하항(POD)'"></th>
								<td th:colspan="3">
									<input type="text" class="sm" name="podCd">
									<a href="#" class="btn-anchor" th:alt="'검색'" onclick="javascript:window.open('/info/edi/copinoPortList?code=pod', 400, 400);"></a>
									<input type="text" name="podNm">
								</td>
							</tr>
							<tr>
								<th th:text="'구분'"></th>
								<td th:colspan="3">
									<select name="orderCd">
										<option value="BO" th:text="'B/O Num.'"></option>
									</select>
									<input type="text" name="orderNo">
								</td>
							</tr>
							<tr>
								<th th:text="'조작코드'"></th>
								<td th:colspan="3">
									<input type="text" class="sm" name="cmcNo">
								</td>
							</tr>
							<tr>
								<th th:text="'화주명'"></th>
								<td th:colspan="3">
									<input type="text" name="customerNm"><br/>
									<p style='color: red; font-weight: 600;' th:text="' * 실화주명이 아닌 숫자, 특수기호, 선사, 포워딩명을 넣으시면 정상처리 되지 않습니다.'"></p>
								</td>
							</tr>
						</tbody>
					</table>
					<div class="btn-container">
						<a id="searchBtn" class="btn_lookup">전송하기</a>
					</div>
				</div>
				
			</form>
			<script type="text/javascript">
				$(function(){
					if( getParameter('save') > 0 ) {
						alert( '정상적으로 처리되었습니다.' );
						location.href = "/info/edi/copinoGateInRsrv";
					}
					
					$("#estDay").val( moment().format('YYYY-MM-DD') )
					
					$("#saveBtn").click(function() {
						var d = $(document.saveForm).serializeObject();
						
						send( '/info/edi/copinoErrCheck', d, function(r) {
							console.log(r);
						}, 'POST' );
					});
					
					$("#cntrSzCdSelect").change(function() {
						$("#sztpCd").val('');
						$("#cntrSzSelect").children().each(function(idx, item) {
							if( $(item).is(":selected") ) $(item).removeAttr("selected");
							
							var sz = $("#cntrSzCdSelect").val();
							if( $(item).attr("data-szcd") == sz ) {
								$(item).css("display", "");
							} else {
								$(item).css("display", "none");
							}
						});
						
						var children = $("#cntrSzSelect").children();
						for( var i=0; i<children.length; i++ ) {
							if( $(children[i]).attr("data-szcd") == $("#cntrSzCdSelect").val() ) {
								$(children[i]).attr("selected", "true");
								break;
							}
						}
					});
					
					$("#cntrSzSelect").change( function() {
						$("#sztpCd").val( $(this).val() );
					});
				});
				
				function carFind() {
					if( document.saveForm.carNo.value == "" ) {
						alert( '차량번호를 입력하지 않았습니다. 차량번호를 입력하시고 눌러주세요.' );
						document.saveForm.carNo.focus();
						return;
					} else if( document.saveForm.carNo.value.length != 8 ) {
						alert( '차량번호는 영문4자리 + 숫자4자리로 8자리를 입력하셔야 합니다.' );
						document.saveForm.carNo.focus();
						return;
					}
					
					window.open( '/info/edi/copinoCarFind?carNo=' + document.saveForm.carNo.value, 400, 300 );
				}
			</script>
		</section>
		
	</div>
</html>